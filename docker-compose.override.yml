version: "2"
services:
  my-mvc-app:
    # Depends on docker/compose issue #4790
    # build:
    #   dockerfile: MyMvcApp.Dockerfile
    #   target: develop
    image: my-mvc-app:develop
    volumes:
    - .:/.src
    ports:
    - "5000:80"
    environment:
      ASPNETCORE_ENVIRONMENT: Development
    command: dotnet run
  my-mvc-app-tests:
    build:
      dockerfile: MyMvcApp.Tests.Dockerfile
      context: .
    image: my-mvc-app:develop
    volumes:
    - .:/.src
    command: dotnet test
  my-other-app:
    # Depends on docker/compose issue #4790
    # build:
    #   dockerfile: MyOtherApp.Dockerfile
    #   target: develop
    image: my-mvc-app:develop
    volumes:
    - .:/.src
    ports:
    - "5001:80"
    command: dotnet run
